name: assembly::base::0.1
description: base network service to setup networks and jumphost
properties:
  deploymentLocation:
    description: the name of the location for this assemblies resources to be deploy
    type: string
    default: devstack
  resourceManager:
    description: the name of the resource manager that manages the resources
    type: string
    default: defaultrm
  mgmt_networkid:
    description: network id for mgmt network
    type: read_only
    value: ${mgmt_network.networkid}
  voice_networkid:
    description: network id for mgmt network
    type: read_only
    value: ${voice_network.networkid}
  jumphost_ip:
    type: string
    value: ${jumphost.jumphost_ip}
  jumphost_username:
    type: string
    value: ${jumphost.jumphost_username}
  jumphost_password:
    type: string
    value: ${jumphost.jumphost_password}
composition:
  mgmt_network:
    properties:
      deploymentLocation:
        value: ${deploymentLocation}
      resourceManager:
        value: ${resourceManager}
      subnet:
        value: 10.20.1.0/24
    type: assembly::network::1.0
    quantity: 1
  voice_network:
    properties:
      deploymentLocation:
        value: ${deploymentLocation}
      resourceManager:
        value: ${resourceManager}
      subnet:
        value: 10.10.0.0/24
    type: assembly::network::1.0
    quantity: 1
  router:
    properties:
      deploymentLocation:
        value: ${deploymentLocation}
      resourceManager:
        value: ${resourceManager}
      router_name:
        value: jumprouter
      network:
        value: public
      interface:
        value: ${mgmt_network.subnetid}
    type: assembly::neutron-router::0.1
    quantity: 1
  jumphost:
    properties:
      deploymentLocation:
        value: ${deploymentLocation}
      resourceManager:
        value: ${resourceManager}
      networkid:
        value: ${mgmt_network.networkid}
      keyname:
        value: jumphost
    type: assembly::jumphost::0.1
    quantity: 1
relationships:
  wait:
    properties:
      dummy:
        value: '1'
    lifecycle:
      Create: []
      Cease: []
    source-state: Inactive
    source-state-modifier: pre
    target-state: Active
    target-state-modifier: post
    source-capabilities:
    - jumphost.capability
    target-requirements:
    - router.requirement
